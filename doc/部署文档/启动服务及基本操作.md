
<br/>
# 一、增加accounts应用

## 1. 将django_cms项目的accounts应用拷贝到z我们的项目根目录zhuiyinggu中。

<br/>
## 2. 编辑项目的s `ettings.py`文件：

    
    $ vim zhuiyinggu/settings.py


#### 2.1 增加我们的新应用：


    # Application definition

    INSTALLED_APPS = [
        'django.contrib.admin',
        'django.contrib.auth',
        'django.contrib.contenttypes',
        'django.contrib.sessions',
        'django.contrib.messages',
        'django.contrib.staticfiles',
        'accounts.apps.AccountsConfig',  # 增加我们的新应用
        'rest_framework',
        'guardian',
        'rest_framework.authtoken',  # 增加rest_framework的token认证方式
    ]


#### 2.2 设置使用我们在accounts应用中定义的新的User模型：


    AUTH_USER_MODEL = 'accounts.MyUser'



#### 2.3 设置accounts应用中相关的REST_FRAMEWORK条件设置：


    # REST Framework 相关设置
    # 其设置 全为 “全局设置”
    # -----------------------

    REST_FRAMEWORK = {

        #设置认证方式 为 rest 的token认证
        'DEFAULT_AUTHENTICATION_CLASSES': (
            'rest_framework.authentication.TokenAuthentication',
        ),

        '''
        # 设置过滤器 为 rest 的过滤器
        'DEFAULT_FILTER_BACKENDS': ('rest_framework.filters.DjangoFilterBackend',)
        '''

        # 设置按用户和匿名用户限流
        'DEFAULT_THROTTLE_CLASSES': (
            'rest_framework.throttling.AnonRateThrottle',
            'rest_framework.throttling.UserRateThrottle',
        ),
        'DEFAULT_THROTTLE_RATES': {
            'anon': '1000/day',
            'user': '100/day',
        },

        # 增加分页
        'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
        'PAGE_SIZE': 10,

        # 设置按作用域限流
        'DEFAULT_THROTTLE_CLASSES': (
            'rest_framework.throttling.ScopedRateThrottle',
        ),
        'DEFAULT_THROTTLE_RATES': {
            'user': '1000/day',
            'systemuserprofile': '1000/day',
            'userprofile': '1000/day',
        }

    } 


<br/>
## 3. 在根目录的urls.py文件中增加我们accounts应用的url路径：


    from django.conf.urls import url, include, patterns  # 导入include方法
    from django.contrib import admin

    urlpatterns = [
        url(r'^admin/', admin.site.urls),
        url(r'^accounts/', include('accounts.urls')),  # 增加accounts应用对应的url路径
    ]


<br/>
## 4. 更新数据库


    $ python manage.py makemigrations
    $ python manage.py migrate



<br/>
<br/>
# 二、 启动Django服务

<br/>
## 1. 启用cms虚拟环境：


    $ source /usr/local/python34/bin/virtualenvwrapper.sh
    $ workon cms


<br/>
## 2. 创建管理界面的后台管理员：


    python manage.py createsuperuser


![创建后台管理员](image/08.png)


<br/>
## 3. 启动Django服务：


    $ python manage.py runserver 139.129.233.168:55555


**使用我们新注册的后台管理员账号登录后台管理界面：**
![登录界面](image/09.png)

<br/>
**在管理界面中我们可以看到我们accounts应用中增加的用户模型：**
![管理界面](image/10.png)




